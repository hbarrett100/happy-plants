{% extends "layout.html" %}
{% block content %}
<h1>hoem page!</h1>
<p id="homepage-error">test</p>
<p id="calendar-test">cal test</p>
<button id='newplant'>Add new plant</button>
<button id='calendar'>Add to calendar</button>
<button id='calendar'>delete plant</button>


<!-- these scripts will all move to new file, just testing now -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>

    // Get the current user email from flask
    const CURRENT_USER = "{{user_email}}"
    const TEMP_PLANT_NAME = 'con'


    let plant = "{{user_plants_info}}"


    // hardcoding example input to test
    $('#newplant').click(function () {
        console.log("adding" + TEMP_PLANT_NAME);
        let plantName = TEMP_PLANT_NAME;
        let comments = "direct sunlight";
        let interval = 'weeks';
        let frequency = 2;
        // format of time will be from jquery datetime picker
        let start_date = '30-05-2020 18:00:00'

        // send post request
        $.post("/new_plant", { email: CURRENT_USER, plant_name: plantName, comments: comments, interval: interval, frequency: frequency, start_date: start_date }, function (result) {
            if (result == 'unique constraint') {
                $('#homepage-error').html("Plant already exists")
            } // else here to use the json strings returned to populate the table and show to user
        });
    });


    $('#calendar').click(function () {
        console.log("adding " + TEMP_PLANT_NAME + " to calendar");
        let plantName = TEMP_PLANT_NAME;
        let comments = "direct sunlight";
        let interval = 2;
        let frequency = 'weeks';
        // format of time will be from jquery datetime picker
        let start_date = '30-05-2020 18:00:00'

        // send post request
        $.post("/add_to_calendar", { email: CURRENT_USER, plant_name: plantName, comments: comments, interval: interval, frequency: frequency, start_date: start_date }, function (result) {
            if (result) {
                $('#calendar-test').html("Event added to google calendar")
            }
        });
    });


    // function to remove a plant from database and calendar
    // no need to have any callback function here? 
    $('#removePlant').click(function () {
        let plantName = 'cactus';
        $.get("/remove_plant", { email: CURRENT_USER, plant: plantName })
    });

</script>
{% endblock %}